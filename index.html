<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.16: http://docutils.sourceforge.net/" />
<title>Welcome to the YAG-OSDL documentation</title>
<meta content="OSDL-Snake, YAG, YAG-OSDL, gallery, HTML" name="keywords" />
<link rel="stylesheet" href="pygments-default.css" type="text/css" />
<link rel="stylesheet" href="osdl-snake.css" type="text/css" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
<div class="document">


<span class="target" id="top"></span><p><span class="raw-html"><a name="yagosdl_top"></a></span></p>
<p><span class="raw-html"><div class="banner"><p><em>YAG-OSDL documentation</em> <a href="http://snake.esperide.org/yag-osdl.html">browse latest</a> <a href="https://olivier-boudeville.github.io/OSDL-Snake/index.html">browse mirror</a> <a href="yag-osdl.pdf">get PDF</a> <a href="#yagosdl_top">go to top</a> <a href="#yagosdl_bottom">go to bottom</a> <a href="https://github.com/Olivier-Boudeville/OSDL-Snake">go to project</a> <a href="mailto:about(dash)yag-osdl(at)esperide(dot)com?subject=[OSDL-Snake]%20YAG-OSDL%20Remark">email us</a></div></span></p>
<div class="section" id="yag-osdl-homepage">
<h1>YAG-OSDL Homepage</h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Organisation:</th><td class="field-body"><p class="first">Copyright (C) 2004-2021 Olivier Boudeville</p>
</td>
</tr>
<tr class="field"><th class="field-name">Contact:</th><td class="field-body"><p class="first">about (dash) yag-osdl (at) esperide (dot) com</p>
</td>
</tr>
<tr class="field"><th class="field-name">Creation date:</th><td class="field-body"><p class="first">Sunday, August 17, 2008</p>
</td>
</tr>
<tr class="field"><th class="field-name">Lastly updated:</th><td class="field-body"><p class="first">Sunday, March 14, 2021</p>
</td>
</tr>
<tr class="field"><th class="field-name">Status:</th><td class="field-body"><p class="first">Stable</p>
</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body"><p class="first">0.8.0</p>
</td>
</tr>
<tr class="field"><th class="field-name">Dedication:</th><td class="field-body"><p class="first">Users of the <tt class="docutils literal"><span class="pre">YAG-OSDL</span></tt> tool.</p>
</td>
</tr>
<tr class="field"><th class="field-name">Abstract:</th><td class="field-body"><p class="first">The role of <a class="reference external" href="http://snake.esperide.org/yag-osdl.html/">YAG-OSDL</a> is to generate static HTML galleries out of a filesystem tree containing snapshots (camera pictures).</p>
<p>Browsing this content can be done according to the tree structure (per gallery, through which one can navigate and that can be nested, each with subgalleries containing thumbnails) or based on themes that themselves form a separate hierarchy (any theme may be further split into subthemes recursively).</p>
<p>Besides themes, a comment may be attached to a snapshot, and will be displayed accordingly.</p>
<p class="last">The next level of information is to read the corresponding <a class="reference external" href="https://github.com/Olivier-Boudeville/OSDL-Snake/yag">source files</a>, which are intensely commented and generally straightforward.</p>
</td>
</tr>
</tbody>
</table>
<div class="section" id="overview">
<h2>Overview</h2>
<p><strong>YAG-OSDL</strong> is a GPL'd cross-platform tool whose purpose is to generate a static website from a set of image files stored in a directory tree, in order to build a full web gallery allowing to browse the pictures pleasantly afterwards, based on navigation options and thumbnails.</p>
<p>Hierarchical thematical sort and comments are supported (see an older <a class="reference external" href="http://osdl-data.esperide.org">example of result</a>).</p>
</div>
<div class="section" id="purpose-of-yag-osdl">
<h2>Purpose of YAG-OSDL</h2>
<p>YAG-OSDL is made of a set of Python scripts that scan a directory tree containing images (ex: JPEG files), and construct out of them a set of HTML pages with thumbnails, offering the possibility to skim through the pictures thanks a standard browser, and according to two different ways:</p>
<ul class="simple">
<li>in a <strong>tree-based fashion</strong>: the user can browse the images according to their directory structure</li>
<li>in a <strong>theme-based fashion</strong>: the user selects a theme and sees which are its sub-themes and which resources belong to that theme (of course it implies that the gallery author filled the theme information thanks to our tools beforehand)</li>
</ul>
<p>Gallery authors are indeed provided with a way of adding their comments for any picture, and also with a way of describing to which theme(s) a given picture belongs.</p>
<p>YAG-OSDL can be easily customised, thanks to its configuration file, whose default name is <tt class="docutils literal"><span class="pre">yag-osdl.conf</span></tt>. Everything can be generated, the portal page included, with comments and terms of use. Web themes (&quot;skins&quot; for galleries, not to be confused with content themes) are supported, and can be customised thanks to CSS (<em>Cascading Style Sheets</em>).</p>
<p>We developed YAG-OSDL as we needed a tool that would archive our graphical resources so that we could browse quickly through them, either for holiday pictures or to select the assets suitable for, say, a video game: another way of describing YAG-OSDL is indeed: &quot;a media content browser&quot;. We plan to add archiving support for audio content, as soon as we feel enough need for such a feature.</p>
</div>
<div class="section" id="installation">
<h2>Installation</h2>
<p>Current version of YAG-OSDL is 0.8. It relies on Python 3 (ex: 3.9.2 at the time of this writing) and uses a pretty standard <tt class="docutils literal">requirements.txt</tt> file in order to secure its third-party prerequisites thanks to <tt class="docutils literal">pip</tt>. The only extra prerequisite is <a class="reference external" href="https://github.com/Olivier-Boudeville/Ceylan-Snake/">Ceylan-Snake</a>.</p>
</div>
<div class="section" id="inspiration">
<h2>Inspiration</h2>
<p>YAG-OSDL derives from <a class="reference external" href="http://home.planet.nl/~stas.linux/python/yag/">YAG</a>, a previous work from Stas Z (<tt class="docutils literal">linuxisbeter (at) yahoo (dot) com</tt>); thanks!</p>
</div>
<div class="section" id="step-by-step-mini-user-s-guide">
<h2>Step-by-step Mini User's Guide</h2>
<div class="section" id="objective">
<h3>Objective</h3>
<p>You have a directory tree (possibly only a directory, preferably a pre-sorted tree) of image files, such as:</p>
<pre class="literal-block">
MySnapshots
|-- GoldWashing
|   |-- 200407-Chilhac-0096.jpeg
|   |-- 200407-Chilhac-0099.jpeg
|   |-- 200407-Chilhac-0103.jpeg
|   |-- 200407-Chilhac-0113.jpeg
|   |-- 200407-Chilhac-0114.jpeg
|   |-- 200407-Chilhac-0115.jpeg
|   |-- 200407-Chilhac-0116.jpeg
|   `-- 200407-Chilhac-0117.jpeg
`-- InsideVillage
    |-- 200407-Chilhac-0087.jpeg
    |-- 200407-Chilhac-0088.jpeg
    |-- 200407-Chilhac-0089.jpeg
    |-- 200407-Chilhac-0090.jpeg
    `-- 200407-Chilhac-0091.jpeg
</pre>
<p>You want to generate a full web gallery out of it, and you are using GNU/Linux (the Windows platform cannot benefit from helper shell scripts, which will ease the work of the gallery author).</p>
<p>You might have relevant, overall (general) gallery information to associate to this content; let's suppose that you wrote them down in a text file (ex: <tt class="docutils literal">MyInfos.txt</tt>). If your gallery is to be put online, you might have thought to a license and terms of use, that you would have written in another text file (ex: <tt class="docutils literal">MyLicence.txt</tt>).</p>
</div>
<div class="section" id="step-zero-optional-prepare-the-snapshots">
<h3>Step zero (optional): prepare the snapshots</h3>
<p>One may take advantage of the <a class="reference external" href="https://hull.esperide.org/#for-snapshots-camera-pictures">relevant scripts in Ceylan-Hull</a> in order to better manage pictures, namely to fix their filenames as a whole (see <tt class="docutils literal"><span class="pre">rename-snapshots.sh</span></tt> for that) and to remove any associated metadata (typically EXIF information) before publishing (not to disclose timestamps, locations, etc.), thanks to <tt class="docutils literal"><span class="pre">remove-snapshot-metadata.sh</span></tt>.</p>
<p>One may then, once these metadata have been applied (images having been made upright) and cleared, correct the orientation (as some camera mess with them) of the remaining pictures that need it.</p>
<p>For that, one may use <tt class="docutils literal">ImageMagick</tt> for that, precisely:</p>
<pre class="code bash literal-block">
<span class="c1"># Counter-clockwise, in-place rotation:
</span>$ mogrify -rotate <span class="s2">&quot;-90&quot;</span> foobar.jpeg
</pre>
</div>
<div class="section" id="step-one-install-the-yag-osdl-tooling">
<h3>Step one: install the YAG-OSDL tooling</h3>
<div class="section" id="python">
<h4>Python</h4>
<p>First, retrieve and install prerequisites, first of which is <a class="reference external" href="http://python.org/download/">Python</a>, precisely <tt class="docutils literal">Python 3</tt> (we use <tt class="docutils literal">3.9.2</tt> at the time of this writing).</p>
<p>Most probably that your distribution allows to take care of it (example for Arch Linux : <tt class="docutils literal">pacman <span class="pre">-Sy</span> python3</tt>; users of Debian-based distributions can use <tt class="docutils literal"><span class="pre">apt-get</span> install python3</tt>).</p>
<p>Check your actual version with <tt class="docutils literal">python <span class="pre">-V</span></tt>.</p>
</div>
<div class="section" id="id2">
<h4>Ceylan-Snake</h4>
<p><tt class="docutils literal"><span class="pre">YAG-OSDL</span></tt> belongs to <tt class="docutils literal"><span class="pre">OSDL-Snake</span></tt>, which relies on <tt class="docutils literal"><span class="pre">Ceylan-Snake</span></tt>.</p>
<p>This is just a matter of:</p>
<pre class="code bash literal-block">
$ <span class="nb">cd</span> ~/my-projects
$ git clone https://github.com/Olivier-Boudeville/Ceylan-Snake
</pre>
<p>Set in your environment a <tt class="docutils literal">CEYLAN_SNAKE</tt> variable pointing to that clone; ex:</p>
<pre class="code bash literal-block">
$ <span class="nb">export</span> <span class="nv">CEYLAN_SNAKE</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">HOME</span><span class="si">}</span><span class="s2">/my-projects/Ceylan-Snake&quot;</span>
</pre>
</div>
<div class="section" id="yag-osdl-itself">
<h4>YAG-OSDL itself</h4>
<p>Then obtain the YAG-OSDL codebase thanks to, for example:</p>
<pre class="code bash literal-block">
$ <span class="nb">cd</span> ~/my-projects
$ git clone https://github.com/Olivier-Boudeville/OSDL-Snake
$ <span class="nb">cd</span> OSDL-Snake
</pre>
<p>Then the needed Python3 packages, which are listed in <a class="reference external" href="https://github.com/Olivier-Boudeville/OSDL-Snake/yag/requirements.txt">requirements.txt</a>, can be installed with:</p>
<pre class="code bash literal-block">
$ python3 -m pip install -r requirements.txt
</pre>
<p>This only involves installing actually <tt class="docutils literal">Pillow</tt> (which supersedes <tt class="docutils literal">PIL</tt>).</p>
</div>
</div>
<div class="section" id="step-two-edit-your-yag-osdl-configuration-file">
<h3>Step two: edit your YAG-OSDL configuration file</h3>
<p>Simplest solution is to derive it from the sample one:</p>
<pre class="code bash literal-block">
$ cp yag-osdl.conf.sample yag-osdl-for-foobar.conf
</pre>
<p>We hope that the sample is self-describing enough for most uses; yours could be edited that way:</p>
<pre class="code ini literal-block">
<span class="k">[Options]</span>

<span class="c1"># Now can be mostly any string:</span>
<span class="na">project_name</span>          <span class="o">=</span> <span class="s">Moon Photos</span>

<span class="c1"># One may prefer absolute paths for simpler management.</span>

<span class="na">content_directory</span>     <span class="o">=</span> <span class="s">/var/my-encrypted-storage/www/Moon-sources</span>
<span class="c1">#resource_directory    = /home/dalton/Projects/Tools/yag/yag-osdl-latest/resources</span>

<span class="na">output_in_content</span>     <span class="o">=</span> <span class="s">False</span>
<span class="na">output_directory</span>      <span class="o">=</span> <span class="s">/var/my-encrypted-storage/www/Moon</span>

<span class="c1">#language = English</span>
<span class="na">language</span> <span class="o">=</span> <span class="s">French</span>

<span class="c1">#theme                 = OSDL-english-theme</span>
<span class="na">theme</span>                 <span class="o">=</span> <span class="s">OSDL-french-theme</span>

<span class="na">thumbsize</span>             <span class="o">=</span> <span class="s">120</span>
<span class="na">images_by_row</span>         <span class="o">=</span> <span class="s">4</span>
<span class="na">images_by_column</span>      <span class="o">=</span> <span class="s">4</span>
<span class="na">dash_is_space_in_menu</span> <span class="o">=</span> <span class="s">True</span>

<span class="na">author</span>                <span class="o">=</span> <span class="s">William Dalton</span>
<span class="na">author_mail</span>           <span class="o">=</span> <span class="s">william.dalton&#64;maverick.org</span>
</pre>
</div>
<div class="section" id="step-three-annotate-the-images-thanks-to-our-helper-scripts">
<h3>Step three: annotate the images, thanks to our helper scripts</h3>
<div class="section" id="to-trigger-the-annotation-process">
<h4>To Trigger the Annotation Process</h4>
<p>If we launch YAG-OSDL now, a full gallery will be generated, yet no comment nor theme information will be available.</p>
<p>If one wants to provide them, just enter, for example, from the OSDL-Snake root:</p>
<pre class="code bash literal-block">
$ <span class="nv">MY_CONTENT_ROOT</span><span class="o">=</span><span class="s2">&quot;/var/my-encrypted-storage/www/Moon-sources&quot;</span>
$ ./annotate-images.sh <span class="si">${</span><span class="nv">MY_CONTENT_ROOT</span><span class="si">}</span>
</pre>
<p>We hereby suppose that two really common tools are available on your computer:</p>
<ul class="simple">
<li>a text editor, <tt class="docutils literal">emacs</tt> or any that you like; just define the <tt class="docutils literal">EDITOR</tt> environment variable accordingly (ex: <tt class="docutils literal">export EDITOR=vim</tt>) to override</li>
<li>an image viewer; various ones will be looked-up; to select a particular one, just define the <tt class="docutils literal">IMAGE_VIEWER</tt> environment variable accordingly</li>
</ul>
</div>
<div class="section" id="commenting-galleries-images">
<h4>Commenting Galleries &amp; Images</h4>
<p>The <a class="reference external" href="https://github.com/Olivier-Boudeville/OSDL-Snake/blob/master/yag/annotate-images.sh">annotate-images.sh</a> script (which uses <a class="reference external" href="https://github.com/Olivier-Boudeville/OSDL-Snake/blob/master/yag/handle-image.sh">handle-image.sh</a>) will guide you and will trigger the appropriate tools.</p>
<p>That is, it will first fire a text editor for each encountered <em>gallery</em> when scanning your content tree.</p>
<p>On the example above, it would be first <tt class="docutils literal">MySnapshots</tt>, then <tt class="docutils literal">GoldWashing</tt>, and then <tt class="docutils literal">InsideVillage</tt>. In each of the corresponding files, feel free to give overall information relative to the content in that gallery directory.</p>
<p>After this gallery-commenting phase, the next phase will be the <em>per-content</em> commenting. Indeed, for each image in the content tree, <tt class="docutils literal"><span class="pre">annotate-images.sh</span></tt> will launch the specified image viewer to display that picture (so that you are reminded of it), and then a first text editor is fired, where you may enter any <em>comments</em> <a class="footnote-reference" href="#id4" id="id3">[1]</a> you may have regarding that content.</p>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[1]</a></td><td>The files dedicated to comments bear the <tt class="docutils literal">.txt</tt> extension.</td></tr>
</tbody>
</table>
<p>When this comment writing is over, closing the text editor will trigger a new instance of it, as explained in the section.</p>
</div>
<div class="section" id="adding-thematical-information">
<h4>Adding Thematical Information</h4>
<p>This time, the <em>theme information</em> <a class="footnote-reference" href="#id6" id="id5">[2]</a> (if any) associated to this image is to be specified.</p>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[2]</a></td><td>The files dedicated to themes bear the <tt class="docutils literal">.thm</tt> extension.</td></tr>
</tbody>
</table>
<div class="section" id="per-content-themes">
<h5>Per-Content Themes</h5>
<p>How to tell that your image belongs to themes <tt class="docutils literal">Surf</tt> and <tt class="docutils literal">Hawaï</tt>, and that the theme <tt class="docutils literal">Surf</tt> is a sub-theme of the <tt class="docutils literal">Awful activities</tt> theme? Simply, in the spawned theme file, enter on the first line:
<tt class="docutils literal">Awful activities: Surf</tt> and in the second <tt class="docutils literal">Hawaii</tt>. That's it, YAG-OSDL has all the information that it needs in order to perform its sorting work.</p>
<p>You can therefore close the image window (you have finished with that one) and this theme file, and repeat the process:</p>
<blockquote>
<ol class="arabic simple">
<li>view the current image</li>
<li>enter its comment (if any) and close the text editor</li>
<li>enter its theme information (if any), close the image viewer and the text editor (preferably in that order)</li>
<li>repeat from point 1 until <tt class="docutils literal"><span class="pre">annotate-images.sh</span></tt> stops with <tt class="docutils literal">Annotations finished !</tt>, which means that you went successfully through the whole comment and thematical enrichment process</li>
</ol>
</blockquote>
<p>Note that you can at any time stop the annotation script, as no entered information will be lost: by re-launching the script the same way that you launched it, you will be able first to validate or update every already available information you gave, until you reach the point where you stopped. You will then just have to continue the enrichment process from then on.</p>
</div>
<div class="section" id="another-way-of-defining-the-theme-hierarchy">
<h5>Another Way of Defining the Theme Hierarchy</h5>
<p>There is an alternative or complementary method in order to define your theme tree: instead of specifying the link between themes at the level of a given image <a class="footnote-reference" href="#id8" id="id7">[3]</a>, a standalone theme file whose name is <tt class="docutils literal"><span class="pre">yag-overall-themes.thm</span></tt> can be used. This file should be placed at the root of your content, and might have the usual structure:</p>
<pre class="literal-block">
father-theme: a-child-theme
</pre>
<table class="docutils footnote" frame="void" id="id8" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[3]</a></td><td>Knowing that a given father/child theme relationship can be specified only once, at the level of any related content.</td></tr>
</tbody>
</table>
<p>as shown here:</p>
<pre class="literal-block">
Awful activities: sailing
Awful activities: surf
Awful activities: yoga

surf: Hawaii-2003
surf: Hawaii-2004
surf: Snapshots Of The Shark That Ate My Board
</pre>
<p>This standalone theme file proved useful, since, that way, all the theme tree can be defined and understood in one place.</p>
<p>However, any combination of theme specifications will work: one can both use image theme files and the standalone theme file.</p>
</div>
</div>
</div>
<div class="section" id="step-four-launch-yag-osdl">
<h3>Step four: launch YAG-OSDL</h3>
<p>Still following the example, one just have to run:</p>
<pre class="code bash literal-block">
$ run-yag-osdl.sh --config yag-osdl-for-foobar.conf
</pre>
</div>
<div class="section" id="step-five-admire-the-result">
<h3>Step five: admire the result</h3>
<p>Use your browser to inspect your stunning new gallery, improve comments and themes if necessary and, if you feel like it should be put online, copy the whole content directory to a webserver, add a link to the gallery main page and tell all your friends about it!</p>
</div>
</div>
<div class="section" id="licence">
<span id="free-software"></span><h2>Licence</h2>
<p>The one of the original work applies, namely the <a class="reference external" href="http://www.gnu.org/licenses/gpl-3.0.html">GNU General Public License</a> (GPL), version 3.0 or later.</p>
</div>
<div class="section" id="support">
<h2>Support</h2>
<p>Bugs, questions, remarks, patches, requests for enhancements, etc. are to be reported (please specify it relates to YAG-OSDL) to the <a class="reference external" href="https://github.com/Olivier-Boudeville/OSDL-Snake">project interface</a> (typically <a class="reference external" href="https://github.com/Olivier-Boudeville/OSDL-Snake/issues">issues</a>) or directly at the email address mentioned at the beginning of this document.</p>
</div>
<div class="section" id="please-react">
<h2>Please React!</h2>
<p>If you have information more detailed or more recent than those presented in this document, if you noticed errors, neglects or points insufficiently discussed, drop us a line! (for that, follow the <a class="reference internal" href="#support">Support</a> guidelines).</p>
<p>Have fun with YAG-OSDL!</p>
<p><span class="raw-html"><a name="yagosdl_bottom"></a></span></p>
</div>
</div>
</div>
</body>
</html>
